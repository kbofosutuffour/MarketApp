{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'home_style.css' %}">
    <title>H2H | Homepage</title>
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js">
    </script>
    <script src="{% static 'home.js' %}"></script>

</head>
<body>

    <div id = 'top-bar' style="width: 100%; margin-bottom: 5px;">

        {% if user.is_authenticated %}
            <div style="margin-right: 90%; display: inline; width: fit-content;"><h2 style="position: relative; top:25%">Welcome, {{user.username}}!</h2></div>
        {% else %}
            <div style="margin-right: 90%; display: inline; width: fit-content;"><h2 style="position: relative; top:25%">Welcome, Guest!</h2></div>
        {% endif %}

        <div id="search-login">
            <img id="search" src="{% static 'media/search.png' %}" style="display: block; width: 30px; padding-bottom: 20%"/>

            {% if user.is_authenticated %}
            <a href="logout" ><button id="login">Logout</button></a>
            {% else %}
            <a href="login" ><button id="login">Login</button></a>
            {% endif %}   
        </div>
 
    </div>
    
    {% for post in posts %}
    <div class="post" >
        <div class="post-image-div" display="inline-block" >
            <img class="post-image" src="{{ post.image.url }}"/>
        </div>
        <div class ="post-text" display="inline-block" >
            <h3 class="product">{{post.product}}</h3>
            <h4 class="username">{{post.username}}</h4>
            <h3 class="price">${{post.price}}</h3>
        </div>
        <div class="edit-post" id="edit-post"  >
            <div class="buttons" onclick=edit_post() ><a><img src="{% static 'media/edit_post.png' %}" style="width: 20px"></a></div>
            <div class="post-drop-down">
                <ul style = "list-style-type:none; margin: 0; padding: 0">
                    {% if user.is_authenticated and post.username == user.get_username %}
                    <li>Edit Post</li>
                    {% endif %}
                    <li>Save Post</li>
                    <li>Flag Post</li>
                </ul>
    
    
            </div>
        </div>

    </div> 
    {% endfor %}


    
    <a href="new_post"><img id="new-post" src="{% static 'media/plus_sign.png' %}" style="position: sticky; right: 10px; width: 50px; margin-left: 90%;" /></a>
    <footer>
        <ul>
            <li class = "footer_img"><a href="returnHome"><img src="{% static 'media/home.png' %}" id="home"/></a></li>
            <li class = "footer_img"><a href="" id="to-chat"><img src="{% static 'media/chat.png' %}" id="chats"/></a></li>
            <li class = "footer_img"><a href="profile" id="to-profile"><img src="{% static 'media/profile.png' %}" id="profile" /></a></li>
        </ul>
   </footer>
   <!-- <script>
    $(document).ready(function() {
        //setInterval(function(){
            $.ajax({
                type: 'GET',
                url: "{% url 'getImage' %}",
                success: function(response) {
                    $("#front").empty();
                    for(var key in response.posts) {
                        prod = response.posts[key].product
                        
                        let string = '<img id="post-image" src="'
                        string = string.concat("{% static 'post_images/")
                        // <img id='post-image' src="{% static 'post_images/Airpods.jpg' %}"/>
                        // <img id='post-image' src="{% static 'post_images/Airpods.jpg' %}"/>

                        string = string.concat(prod)
                        string = string.concat(".jpg' %}", '"/>')
                        console.log(string)

                    $("#front").append(string);
                    }
                },
                error: function(response) {
                    alert('Error getting data')
                }
            })

        },1000) 

    //}); 
   </script> -->
</body>
</html>